<html>
<head>
<style>
body{
  background-color: #fff;
  color: #000;
}
#box canvas {
  background-color: #000;
}
.content {
  position: relative;
  width: 100%; 
  margin: auto;
  text-align: center;
  padding-top: 40px;
}
a, a.active, a.visited, a.hover{
  color: #000;
  text-decoration: none;
}
</style>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="lib/three.min.js"></script>
<script src="color/color.js"></script>
<script type="x-shader/x-vertex" id="vertexShader">

attribute vec3 color;
varying vec3 vPosition;
varying vec3 vColor;
varying vec3 vNormal;

vec3 newpos;
float alive;

void main(){
  vPosition = position;
  vColor = color;
  vNormal = normal;

  alive = normal.z;
  newpos = position + vec3(10000.0,10000.0,0.0)*alive;

  gl_Position = projectionMatrix *
    modelViewMatrix *
    vec4(newpos,1.0);
}

</script>

<script type="x-shader/x-fragment" id="fragmentShader">

varying vec3 vPosition;
varying vec3 vColor;
varying vec3 vNormal;
uniform float size;
uniform float opacity;

float rand(vec2 co){
  return fract(sin(dot(co.xy,vec2(12.9898,78.233)))* 43758.5453);
}

void main(){

  float pixOpacity = (1.0-clamp(abs(vNormal.y)/size*40.0,0.0,0.95));
  
  gl_FragColor = vec4(
    vColor.x,
    vColor.y,
    vColor.z,
    pixOpacity*rand(vPosition.xy+vColor.xy)
    //opacity
    //opacity*rand(vPosition.xy+vColor.xy)
  );
}

</script>
</head>
<body>
<div class="content">
  <div id="box"></div>
  <script src="src/meander.js"></script>
</div>
</body>
</html>
